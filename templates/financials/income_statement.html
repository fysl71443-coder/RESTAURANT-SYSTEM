{% extends 'base.html' %}
{% block title %}قائمة الدخل{% endblock %}
{% block content %}
<div class="container py-4">
  <h3>قائمة الدخل (Advanced Income Statement)</h3>

  <form method="get" class="row g-2 align-items-end mb-3">
    <div class="col-auto">
      <label>الفترة</label>
      <select name="period" class="form-select">
        <option value="today" {% if data.period=='today' %}selected{% endif %}>اليوم</option>
        <option value="this_week" {% if data.period=='this_week' %}selected{% endif %}>هذا الأسبوع</option>
        <option value="this_month" {% if data.period=='this_month' %}selected{% endif %}>هذا الشهر</option>
        <option value="this_year" {% if data.period=='this_year' %}selected{% endif %}>هذه السنة</option>
        <option value="custom" {% if data.period=='custom' %}selected{% endif %}>مخصص</option>
      </select>
    </div>
    <div class="col-auto">
      <label>من تاريخ</label>
      <input type="date" name="start_date" class="form-control" value="{{ data.start_date }}">
    </div>
    <div class="col-auto">
      <label>إلى تاريخ</label>
      <input type="date" name="end_date" class="form-control" value="{{ data.end_date }}">
    </div>
    <div class="col-auto">
      <button class="btn btn-primary">عرض</button>
    </div>

  <div class="d-flex gap-2 mb-3">
    <a class="btn btn-outline-secondary" href="{{ url_for('financials.balance_sheet') }}">المركز المالي</a>
    <a class="btn btn-outline-secondary" href="{{ url_for('financials.trial_balance') }}">ميزان المراجعة</a>
  </div>

  </form>

  <div class="row g-3">
    <div class="col-md-3"><div class="card p-3"><h6>الإيرادات</h6><h4>{{ '%.2f'|format(data.revenue) }}</h4></div></div>
    <div class="col-md-3"><div class="card p-3"><h6>تكلفة المبيعات (COGS)</h6><h4>{{ '%.2f'|format(data.cogs) }}</h4></div></div>
    <div class="col-md-3"><div class="card p-3"><h6>الربح الإجمالي</h6><h4>{{ '%.2f'|format(data.gross_profit) }}</h4></div></div>
    <div class="col-md-3"><div class="card p-3"><h6>المصاريف التشغيلية</h6><h4>{{ '%.2f'|format(data.operating_expenses) }}</h4></div></div>
    <div class="col-md-3"><div class="card p-3"><h6>الربح التشغيلي</h6><h4>{{ '%.2f'|format(data.operating_profit) }}</h4></div></div>
    <div class="col-md-3"><div class="card p-3"><h6>دخل آخر</h6><h4>{{ '%.2f'|format(data.other_income) }}</h4></div></div>
    <div class="col-md-3"><div class="card p-3"><h6>مصروفات أخرى</h6><h4>{{ '%.2f'|format(data.other_expenses) }}</h4></div></div>
    <div class="col-md-3"><div class="card p-3"><h6>الربح قبل الضريبة</h6><h4>{{ '%.2f'|format(data.net_profit_before_tax) }}</h4></div></div>
    <div class="col-md-3"><div class="card p-3"><h6>ضريبة (دخل)</h6><h4>{{ '%.2f'|format(data.tax) }}</h4></div></div>
    <div class="col-md-3"><div class="card p-3"><h6>الربح بعد الضريبة</h6><h4>{{ '%.2f'|format(data.net_profit_after_tax) }}</h4></div></div>
  </div>

  <div class="mt-3"><small>الفترة: {{ data.start_date }} إلى {{ data.end_date }}</small></div>
</div>
{% endblock %}
