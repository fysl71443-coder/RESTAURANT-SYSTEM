{% extends 'base.html' %}{% set back_url = url_for('dashboard') %}
{% block title %}{{ _('Employees / الموظفون') }}{% endblock %}
{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="mb-0">👤 {{ _('Employees / الموظفون') }}</h3>
    <div class="d-flex flex-wrap gap-2">
      <a href="{{ url_for('salaries_monthly') }}" class="btn btn-success">💵 {{ _('Monthly Salaries / رواتب شهرية') }}</a>
      <a href="{{ url_for('salaries_statements') }}" class="btn btn-outline-success">🧾 {{ _('Payroll Statements / كشوفات الرواتب') }}</a>
      <a href="{{ url_for('salaries') }}" class="btn btn-outline-secondary">📝 {{ _('Salaries Form / نموذج الرواتب') }}</a>
      <a href="{{ url_for('dashboard') }}" class="btn btn-primary">🏠 {{ _('Dashboard / لوحة التحكم') }}</a>
    </div>
  </div>

  <div class="card mb-4">
    <div class="card-body">
      <form method="POST">
        {{ form.hidden_tag() }}
        <div class="row g-3">
          <div class="col-md-3">{{ form.employee_code.label(class_='form-label') }}{{ form.employee_code(class_='form-control') }}</div>
          <div class="col-md-3">{{ form.full_name.label(class_='form-label') }}{{ form.full_name(class_='form-control') }}</div>
          <div class="col-md-3">{{ form.national_id.label(class_='form-label') }}{{ form.national_id(class_='form-control') }}</div>
          <div class="col-md-3">{{ form.status.label(class_='form-label') }}{{ form.status(class_='form-select') }}</div>
          <div class="col-md-3">{{ form.department.label(class_='form-label') }}{{ form.department(class_='form-control') }}</div>
          <div class="col-md-3">{{ form.position.label(class_='form-label') }}{{ form.position(class_='form-control') }}</div>
          <div class="col-md-3">{{ form.phone.label(class_='form-label') }}{{ form.phone(class_='form-control') }}</div>
          <div class="col-md-3">{{ form.email.label(class_='form-label') }}{{ form.email(class_='form-control') }}</div>
          <div class="col-md-3">{{ form.hire_date.label(class_='form-label') }}{{ form.hire_date(class_='form-control') }}</div>
        </div>
        <div class="text-end mt-3">
          {{ form.submit(class_='btn btn-success') }}
        </div>
      </form>
    </div>
  </div>

  {% if employees %}
  <div class="card">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-striped">
          <thead class="table-dark">
            <tr>
              <th>#</th>
              <th>{{ _('Code / الرمز') }}</th>
              <th>{{ _('Name / الاسم') }}</th>
              <th>{{ _('National ID / الهوية') }}</th>
              <th>{{ _('Department / القسم') }}</th>
              <th>{{ _('Position / الوظيفة') }}</th>
              <th>{{ _('Phone / الهاتف') }}</th>
              <th>{{ _('Email / البريد') }}</th>
              <th>{{ _('Hire Date / التعيين') }}</th>
              <th>{{ _('Status / الحالة') }}</th>
              <th>{{ _('Actions / الإجراءات') }}</th>
            </tr>
          </thead>
          <tbody>
            {% for e in employees %}
            <tr>
              <td>{{ loop.index }}</td>
              <td>{{ e.employee_code }}</td>
              <td>{{ e.full_name }}</td>
              <td>{{ e.national_id }}</td>
              <td>{{ e.department or '-' }}</td>
              <td>{{ e.position or '-' }}</td>
              <td>{{ e.phone or '-' }}</td>
              <td>{{ e.email or '-' }}</td>
              <td>{{ e.hire_date or '-' }}</td>
              <td>{{ _('Active / نشط') if e.status=='active' else _('Inactive / غير نشط') }}</td>
              <td>
                <a href="{{ url_for('edit_employee', emp_id=e.id) }}" class="btn btn-sm btn-outline-primary">{{ _('Edit / تعديل') }}</a>
                <form method="POST" action="{{ url_for('delete_employee', emp_id=e.id) }}" style="display:inline" onsubmit="return confirmDelete('{{ e.full_name }}')">
                  {{ form.csrf_token }}
                  <button type="submit" class="btn btn-sm btn-outline-danger">{{ _('Delete / حذف') }}</button>
                </form>
              </td>
            </tr>
<script>
function confirmDelete(name){
  return confirm("{{ _('Are you sure to delete / هل أنت متأكد من الحذف؟') }}\n" + name);
}
</script>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
  {% endif %}
</div>
{% endblock %}
